#include "pch.h"

cpu_camera::cpu_camera()
{
	perspective = true;
	fov = XM_PIDIV4;
	width = 16.0f;
	height = 9.0f;
	aspectRatio = width/height;
	near = 0.1f;
	far = 100.0f;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void cpu_camera::UpdateProjection()
{
	if ( perspective )
		XMStoreFloat4x4(&matProj, XMMatrixPerspectiveFovLH(fov, aspectRatio, near, far));
	else
		XMStoreFloat4x4(&matProj, XMMatrixOrthographicLH(width, height, near, far));
}

void cpu_camera::Update()
{
	XMMATRIX mat = XMLoadFloat4x4(&transform.GetInvWorld());
	XMStoreFloat4x4(&matView, mat);
	mat *= XMLoadFloat4x4(&matProj);
	XMStoreFloat4x4(&matViewProj, mat);

	frustum.FromViewProj(matViewProj);
}
